# Redis Internals & Patterns (High-Value)

> Goal: understand Redis beyond “just caching”: data structures, performance, persistence, and common production patterns.

---

## 1) Redis Basics\nRedis is an in-memory data store used for:\n- Caching\n- Sessions\n- Rate limiting\n- Queues\n- Pub/Sub\n\nKey strengths:\n- Very low latency\n- Rich data structures\n\n---\n\n## 2) Core Data Structures (and when to use)\n\n### Strings\nUse for:\n- caching JSON blobs\n- counters\n\n```text\nSET user:10 \"{...}\"\nINCR rate:login:10\n```\n\n### Hashes\nUse for:\n- storing object fields\n\n```text\nHSET user:10 name \"Shohan\" status \"active\"\nHGET user:10 name\n```\n\n### Lists\nUse for:\n- queues (simple)\n\n```text\nLPUSH queue:email job1\nRPOP queue:email\n```\n\n### Sets\nUse for:\n- unique collections\n\n### Sorted Sets\nUse for:\n- leaderboards\n- time-ordered queues\n\n---\n\n## 3) Expiration and TTL\nUse TTL for cache freshness.\n\nPitfalls:\n- many keys expiring at once → stampede\n\nFix:\n- add jitter\n\n---\n\n## 4) Caching Patterns\n\n### Cache-aside\nApp controls cache.\nPros: simple.\nCons: stale possible.\n\n### Write-through\nWrite cache and DB together.\n\n### Negative caching\nCache “not found” for a short TTL.\n\n---\n\n## 5) Rate Limiting\nUse INCR + EXPIRE.\n\nExample:\n```text\nINCR rl:login:10\nEXPIRE rl:login:10 60\n```\n\nIf count > limit → block.\n\n---\n\n## 6) Distributed Locks\nUse SET NX PX.\n\n```text\nSET lock:order:1001 token NX PX 30000\n```\n\nAlways:\n- set expiry\n- release only if token matches\n\n---\n\n## 7) Persistence (RDB vs AOF)\n\n### RDB\n- snapshots\n- faster restarts\n\n### AOF\n- append-only log\n- better durability\n\nMany prod setups use both.\n\n---\n\n## 8) Replication, Sentinel, Cluster\n\n### Replica\n- read scaling\n- failover\n\n### Sentinel\n- monitoring + failover\n\n### Cluster\n- sharding across nodes\n- scales memory and throughput\n\n---\n\n## 9) Common Production Issues\n\n### Memory eviction policies\n- allkeys-lru\n- volatile-lru\n\n### Big keys\nLarge values hurt latency.\n\n### Hot keys\nSingle key hammered by traffic.\nFix:\n- shard keys\n- cache local\n\n---\n\n## 10) Interview Summary\n- Choose correct data structure\n- TTL + invalidation strategy\n- Rate limiting pattern\n- Locks pattern\n- Persistence and HA modes\n\n---\n\n**End of file**\n
